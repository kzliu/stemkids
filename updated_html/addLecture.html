<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<!--meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1"/-->
	<meta name="description" content=""/>
	<meta name="keywords" content=""/>
<!-- 	<meta name="courseId" content="{{courseId}}">
	<meta name="courseTitle" content="{{courseTitle}}">
	<meta name="courseSummary" content="{{courseSummary}}">
	<meta name="lectureNum" content="{{lectureNum}}"> -->

	<title>Create Course {{courseId}}</title>

	<link href="/favicon.ico" rel="icon"/>
	<link href="apple-favicon.png" rel="apple-touch-icon"/>
	<link href="css/new_main.css" type="text/css" rel="stylesheet" media="all"/>
	<link href="css/createcourse.css" type="text/css" rel="stylesheet" media="all"/>
	<link href="css/semantic-ui/semantic.min.css" rel="stylesheet">

	<script src="/socket.io/socket.io.js"></script>
</head>
<body>
	<div class="main">
		<div class="wrapper">
			<h2> Add Lecture {{lectureNum}} to Course {{courseId}}</h2>

			<form class="ui form" method="post" action="/addClass">
				<!-- hidden information for request -->
				<input hidden name="courseId" value="{{courseId}}">
				<input hidden name="courseTitle" value="{{courseTitle}}">
				<input hidden name="courseSummary" value="{{courseSummary}}">
				<input hidden name="lectureNum" value="{{lectureNum}}">

				<div class="field">
				    <label>Course Title</label>
				    <!-- <input type="text" name="course-title" placeholder="Title" hidden> -->
				    <p id="courseTitle">{{ courseTitle }}</p>
				    <!-- <a value="Edit" id="editTitle">Edit</a> -->
				</div>

				<div class="field">
				    <label>Course Summary</label>
				    <!-- <textarea rows="2" placeholder="Summary" id="courseSummaryEdit" hidden></textarea> -->
				    <p id="courseSummary">{{ courseSummary }}</p>
				    <!-- <button value="Edit" id="editCourseSummary">Edit</button> -->
				</div>

				<div class="uiDividingHeader"> </div>
				<div class="field">
				    <label>Lecture Title</label>
				    <input type="text" name="lectureTitle" id="lectureTitle" placeholder="Title">
				</div>

				<div class="url">
				    <label>Video Url</label>
					<div class="uiLabeledInput">
						<div class="ui label">
							http://
						</div>
						<input type="text" id="video" name="video" placeholder="mysite.com">
					</div>
				</div>

				</br>

				<div id="upload">
					<label id="def">Lecture Handout</label>
			    <label for="file" class="uiIconButton">
			        Upload File</label>
			    <input type="file" id="file">
				</div>
				<div class="quizlet">
					<h3>Question 1</h3>
					<div id="quiz">
						<div class="field">
						    <label> </label>
						    <input type="text" name="question1" id="question" placeholder="Question">
						</div>

						<table class="uiTealTable">
							<tr class="centerAligned">
								<td>Answer</td>
								<td>Correct</td>
							</tr>
							<tr class="tableanswerouter">
								<td class="tableanswer">
								    <input type="text" name='answer11' id='answer1' placeholder="Answer 1">
								</td>
								<td class="center aligned">
									<div class="inline field">
									    <div class="ui checkbox">
									      <input type="checkbox" name='answer1corr1' id='answer1corr'>
									      <label></label>
									    </div>
									  </div>
								</td>
							</tr>
							<tr class="tableanswerouter">
								<td class="tableanswer">
								    <input type="text" name='answer21' id='answer2' placeholder="Answer 2">
								</td>
								<td class="center aligned">
									<div class="inline field">
									    <div class="ui checkbox">
									      <input type="checkbox" name='answer2corr1' id='answer2corr'>
									      <label></label>
									    </div>
									  </div>
								</td>
							</tr>
							<tr class="tableanswerouter">
								<td class="tableanswer">
								    <input type="text" name='answer31' id='answer3' placeholder="Answer 3">
								</td>
								<td class="center aligned">
									<div class="inline field">
									    <div class="ui checkbox">
									      <input type="checkbox" name='answer3corr1' id='answer3corr'>
									      <label></label>
									    </div>
									  </div>
								</td>
							</tr>
							<tr class="tableanswerouter">
								<td class="tableanswer">
								    <input type="text" name='answer41' id='answer4' placeholder="Answer 4">
								</td>
								<td class="center aligned">
									<div class="inline field">
									    <div class="ui checkbox">
									      <input type="checkbox" name='answer4corr1' id='answer4corr'>
									      <label></label>
									    </div>
									  </div>
								</td>
							</tr>
						</table>
					</div>
				</div>
				<div id="qstn">
					<button class="ui button">Add Question</button>
				</div>

				<div class="uiDividingHeader"> </div>

				<div id="sbmt">
					<!-- <button class="ui teal button" id="addNewLecture">Submit & Add New Lecture</button> -->
					<button class="ui teal button" type="submit">Submit & Add New Lecture</button>
				</div>

				<div id="finish">
					<button class="ui orange button" type="submit">Upload Course</button>
				</div>
			</form>
		</div>
	</div>

<script type="text/javascript">
var socket = io.connect();
window.addEventListener('load', function(){

	var max_questions = 10; // maximum number of questions allowed
	var i = 1;
	var qzz = $('#quiz');
	var quiz_list = ['#quiz'];

	$('#qstn').click(function(e) {
		e.preventDefault();
		if (i < max_questions) {
			i++;
			$('.quizlet').append('<h3> Question ' + i + '</h3>');
			var id = '#quiz' + i;
			$('#quiz').clone().prop('id', 'quiz' + i).appendTo('.quizlet');
			quiz_list.push(id);
			refactor(id, i);
		};	
	});
	
	// $('#addNewLecture').click(function(e){
	// function processClass() {
	// $('#lectureForm').submit( function(){
	// 	console.log("in submit");
	// 	// e.preventDefault();
	// 	var lectureTitle = $('#lectureTitle').val();
	// 	var video = $('#video').val();
	// 	var length = quiz_list.length;
	// 	var courseId = meta('courseId');
	// 	var courseTitle = meta('courseTitle');
	// 	var obj = {lectureTitle: lectureTitle, lectureNum: meta('lectureNum'), courseSummary: meta('courseSummary'), video: video, courseId: courseId, courseTitle: courseTitle, quizes: {}};
	// 	for (var i = 0; i < length; i++) {
	// 		var quiz = quiz_list[i];
	// 		var question = $(quiz + ' > div.field > input#question').val();
	// 		if (question != ""){
	// 			//fill quiz of i with question and answer/correctness
	// 			obj.quizes[i+1] = {question:question}
	// 			var a = 1;
	// 			$(quiz + ' table.uiTealTable tr.tableanswerouter').each(function() {
	// 			    obj.quizes[i+1]["answer" + a] = $(this).find("#answer" + a).val();
	// 			    obj.quizes[i+1]["corr"+a] = $(this).find("#answer" + a + "corr").prop('checked');
	// 			    a += 1;
	// 			});
	// 		}
	// 	}
	// 	// obj.quizes = JSON.stringify(obj.quizes);
	// 	console.log(obj);
	// 	// e.preventDefault();
	// 	// $.post('/addClass', obj);
	// 	// return false;
	// 	// socket.emit('addClass', lectureTitle, meta('lectureNum'), meta('courseSummary'), video, courseId, courseTitle, obj.quizes);
	// 	// , function( data ) {
	// 	// 	console.log(data);
	// 	// 	// var x=$(window);
	// 	// 	// x.open().write(data);
	// 	// 	// x.close();
	// 	// 	document.write(data);
	// 	// 	console.log("here after post");
	// 	// 	// document.open(data);
	// 	// });
	// 	// return false;
	// 	return true;
	// });	
});

function refactor(quiz, number){
	$(quiz + ' > div.field > input#question').prop('name', 'question'+number);

	var a = 1;
	$(quiz + ' table.uiTealTable tr.tableanswerouter').each(function() {
	    $(this).find("#answer" + a).prop('name', 'answer'+ a + number);
	    $(this).find("#answer" + a + "corr").prop('name', 'answer' + a + 'corr' + number);
	    a += 1;
	});
}

// function meta(name) {
//     var tag = document.querySelector('meta[name=' + name + ']');
//     if (tag != null)
//         return tag.content;
//     return '';
// };

</script>
<script src="css/semantic-ui/semantic.js" type="text/javascript"></script>
<!-- <script src="js/jquery-2.2.0.min.js" type="text/javascript"></script> -->
<script src="https://code.jquery.com/jquery-2.2.0.min.js" type="text/javascript"></script>
<script src="js/main.js" type="text/javascript"></script>
</body>
</html>